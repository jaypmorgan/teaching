<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-10-10 Mon 10:57 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Programming Level-up</title>
<meta name="author" content="Jay Morgan" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">Programming Level-up
<br />
<span class="subtitle">Lecture 4 &#x2013; An Introduction to Numerical Computing in Python</span>
</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgda1a5b2">1. NumPy</a>
<ul>
<li><a href="#org7aba0e1">1.1. What is NumPy</a>
<ul>
<li><a href="#orga61f4b1">1.1.1. What is NumPy?</a></li>
<li><a href="#org888be62">1.1.2. What is NumPy?</a></li>
<li><a href="#org33d1944">1.1.3. Install NumPy</a></li>
<li><a href="#org66530d7">1.1.4. Creating a numpy array</a></li>
</ul>
</li>
<li><a href="#org6775eef">1.2. Working with NumPy</a>
<ul>
<li><a href="#org8687e5c">1.2.1. Basic attributes</a></li>
<li><a href="#orga9488db">1.2.2. Different data types</a></li>
<li><a href="#org828f0e8">1.2.3. Creating arrays with different dtypes</a></li>
<li><a href="#orga93ad47">1.2.4. Changing dtypes</a></li>
<li><a href="#org6615147">1.2.5. Different ways of creating arrays</a></li>
<li><a href="#org2c050dd">1.2.6. Different ways of creating arrays</a></li>
<li><a href="#orge017e19">1.2.7. Different ways of creating arrays</a></li>
<li><a href="#org8c7adc1">1.2.8. Different ways of creating arrays</a></li>
</ul>
</li>
<li><a href="#org8c5c930">1.3. Indexing Arrays</a>
<ul>
<li><a href="#orgc503412">1.3.1. Slicing NumPy arrays</a></li>
<li><a href="#org76d8cf9">1.3.2. Slicing NumPy Arrays</a></li>
<li><a href="#orgfedb997">1.3.3. Slicing NumPy Arrays</a></li>
<li><a href="#org60f6731">1.3.4. Slicing NumPy Arrays</a></li>
<li><a href="#org3a7dda9">1.3.5. Slicing NumPy Arrays</a></li>
<li><a href="#org0e7a4a0">1.3.6. Boolean Indexing</a></li>
<li><a href="#org675b0ba">1.3.7. Boolean Indexing</a></li>
</ul>
</li>
<li><a href="#orgf5d26fc">1.4. Reshaping and Resizing</a>
<ul>
<li><a href="#org25fba56">1.4.1. Reshape</a></li>
<li><a href="#org14d2d01">1.4.2. Flatten</a></li>
<li><a href="#org37fae44">1.4.3. Flatten</a></li>
<li><a href="#org115abe3">1.4.4. Add a dimension</a></li>
<li><a href="#orgf1d423d">1.4.5. Add a dimension</a></li>
<li><a href="#orgd2929f3">1.4.6. Remove a dimension</a></li>
<li><a href="#orgd8d06d0">1.4.7. Matrix transpose</a></li>
<li><a href="#org5a09bed">1.4.8. Composing arrays</a></li>
<li><a href="#org245c738">1.4.9. Composing arrays using concatenate</a></li>
</ul>
</li>
<li><a href="#org99d1fb4">1.5. Arithmetic Operations</a>
<ul>
<li><a href="#org3a6fdbe">1.5.1. Arithmetic Operations</a></li>
<li><a href="#orgad0f7e0">1.5.2. Arithmetic Operations</a></li>
<li><a href="#org3e6894d">1.5.3. Broadcasting</a></li>
<li><a href="#orgef1f6d3">1.5.4. Comparison with Functions</a></li>
<li><a href="#orge48eda8">1.5.5. More complex operations</a></li>
<li><a href="#orgdd40513">1.5.6. More complex operations</a></li>
<li><a href="#orgd1bc3f8">1.5.7. More complex operations</a></li>
<li><a href="#org669236b">1.5.8. Vectorizing a function</a></li>
<li><a href="#org6344f1b">1.5.9. Vectorize a function</a></li>
<li><a href="#orgebe3856">1.5.10. Vectorize a function</a></li>
<li><a href="#orgd87c913">1.5.11. Reading more</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgda1a5b2" class="outline-2">
<h2 id="orgda1a5b2"><span class="section-number-2">1.</span> NumPy</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org7aba0e1" class="outline-3">
<h3 id="org7aba0e1"><span class="section-number-3">1.1.</span> What is NumPy</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-orga61f4b1" class="outline-4">
<h4 id="orga61f4b1"><span class="section-number-4">1.1.1.</span> What is NumPy?</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
NumPy (<a href="https://numpy.org/">https://numpy.org/</a>) is one of the fundamental Python libraries for scientific
computing. In essence, its aim is to make vector and array processing in Python much
more efficient. Therefore, it would be your go-to for (numerical) data
processing.
</p>

<p>
Numerical data processing with NumPy can, most often that not, be magnitudes faster
than what you can write in Python, even if the operations are the same. This is
because NumPy is partly written in C.
</p>

<p>
For example, if we want to compute the matrix multiplication of two arrays:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = [[1, 4], [9, 5]]  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">2 dimensional 'matrices' A and B</span>
<span style="color: #78afff;">B</span> = [[1, 2], [3, 4]]
<span style="color: #78afff;">C</span> = [[0, 0], [0, 0]]  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">our result 'pre-allocated' with zeros</span>

<span style="color: #00c089; font-weight: bold;">for</span> i <span style="color: #00c089; font-weight: bold;">in</span> <span style="color: #3fb83f; font-weight: bold;">range</span>(<span style="color: #3fb83f; font-weight: bold;">len</span>(A)):
    <span style="color: #00c089; font-weight: bold;">for</span> j <span style="color: #00c089; font-weight: bold;">in</span> <span style="color: #3fb83f; font-weight: bold;">range</span>(<span style="color: #3fb83f; font-weight: bold;">len</span>(B)):
        <span style="color: #00c089; font-weight: bold;">for</span> k <span style="color: #00c089; font-weight: bold;">in</span> <span style="color: #3fb83f; font-weight: bold;">range</span>(<span style="color: #3fb83f; font-weight: bold;">len</span>(B)):
            C[i][<span style="color: #78afff;">j</span>] += A[i][k] * B[k][j]
</pre>
</div>
</div>
</div>

<div id="outline-container-org888be62" class="outline-4">
<h4 id="org888be62"><span class="section-number-4">1.1.2.</span> What is NumPy?</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
The previous example is quite un-weidly. We have to manually loop through the
matrices and apply the computation for each element. This can be <b>very</b> slow in
Python. NumPy provides a much cleaner and quicker interface:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #00c089; font-weight: bold;">import</span> numpy <span style="color: #00c089; font-weight: bold;">as</span> np
<span style="color: #78afff;">A</span> = np.array([[1, 4], [9, 5]])
<span style="color: #78afff;">B</span> = np.array([[1, 2], [3, 4]])
<span style="color: #78afff;">C</span> = A @ B  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">or np.matmul(A, B)</span>
<span style="color: #3fb83f; font-weight: bold;">print</span>(C)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[13 18]
# =&gt;  [24 38]]
</pre>
</div>
</div>

<div id="outline-container-org33d1944" class="outline-4">
<h4 id="org33d1944"><span class="section-number-4">1.1.3.</span> Install NumPy</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
Before we can use NumPy, we must first install it if its not already. NumPy can
easily be installed with one of your package managers of choice. For example, if you
want to install via conda:
</p>

<div class="org-src-container">
<pre class="src src-bash">conda install numpy
</pre>
</div>

<p>
or with pip:
</p>

<div class="org-src-container">
<pre class="src src-bash">pip install numpy
</pre>
</div>
</div>
</div>

<div id="outline-container-org66530d7" class="outline-4">
<h4 id="org66530d7"><span class="section-number-4">1.1.4.</span> Creating a numpy array</h4>
<div class="outline-text-4" id="text-1-1-4">
<p>
As we've seen previously, we use <code>np.array</code> to create a numpy array from a Python data type
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
<span style="color: #3fb83f; font-weight: bold;">print</span>(A)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[1 2 3]
# =&gt;  [4 5 6]
# =&gt;  [7 8 9]]
</pre>


<p>
We've created a 3x3 matrix of integers. Note that, out-of-the-box, NumPy doesn't
support <i>ragged arrays</i> (matrices that are not rectangular), so this will not work as
you expect:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([[1], [1, 2]])
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org6775eef" class="outline-3">
<h3 id="org6775eef"><span class="section-number-3">1.2.</span> Working with NumPy</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org8687e5c" class="outline-4">
<h4 id="org8687e5c"><span class="section-number-4">1.2.1.</span> Basic attributes</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
A numpy array has various attributes that are useful for our numerical
computing. Some of these include:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([[1, 4], [9, 5]])

<span style="color: #3fb83f; font-weight: bold;">print</span>(A.shape)  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">the shape of the array</span>
<span style="color: #3fb83f; font-weight: bold;">print</span>(A.size)   <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">number of elements</span>
<span style="color: #3fb83f; font-weight: bold;">print</span>(A.ndim)   <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">number of dimensions</span>
<span style="color: #3fb83f; font-weight: bold;">print</span>(A.nbytes) <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">storage used</span>
<span style="color: #3fb83f; font-weight: bold;">print</span>(A.dtype)  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">data type of elements</span>
</pre>
</div>

<pre class="example">
Results: 
# =&gt; (2, 2)
# =&gt; 4
# =&gt; 2
# =&gt; 32
# =&gt; int64
</pre>
</div>
</div>

<div id="outline-container-orga9488db" class="outline-4">
<h4 id="orga9488db"><span class="section-number-4">1.2.2.</span> Different data types</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
In the previous example, the elements in the array we <code>int64</code>. But normally, we will
see <code>float64</code>. However, there are many other available data types, where each of the
different data types affects how much memory is used to represent the data.
</p>

<ul class="org-ul">
<li>int (8, 16, 32, 64)</li>
<li>uint (unsigned integers)</li>
<li>bool</li>
<li>float (8, 16, 32, 64)</li>
<li>complex</li>
</ul>

<p>
<a href="https://numpy.org/doc/stable/user/basics.types.html">https://numpy.org/doc/stable/user/basics.types.html</a>
<a href="https://numpy.org/doc/stable/reference/arrays.dtypes.html">https://numpy.org/doc/stable/reference/arrays.dtypes.html</a>
</p>
</div>
</div>

<div id="outline-container-org828f0e8" class="outline-4">
<h4 id="org828f0e8"><span class="section-number-4">1.2.3.</span> Creating arrays with different dtypes</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
When creating a NumPy array, NumPy will select what it thinks to be the most
appropriate data type. However, we can tell NumPy explicitly what the data type
should be with the <code>dtype</code> argument.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([[1, 2], [9, 5]], dtype=np.int8)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A.dtype)

A = np.array([[1, 2], [9, 5]], dtype=np.<span style="color: #3fb83f; font-weight: bold;">float</span>)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A.dtype)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[1 2]
# =&gt;  [9 5]]
# =&gt; int8
# =&gt; [[1. 2.]
# =&gt;  [9. 5.]]
# =&gt; float64
</pre>
</div>
</div>

<div id="outline-container-orga93ad47" class="outline-4">
<h4 id="orga93ad47"><span class="section-number-4">1.2.4.</span> Changing dtypes</h4>
<div class="outline-text-4" id="text-1-2-4">
<p>
In some cases, we wish to change the data type of arrays <i>after</i> its creation. For this
we use the <code>.astype()</code> method. This method takes a single argument: the data type you
wish to change the array to.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([1, 2, 3, 4])
<span style="color: #3fb83f; font-weight: bold;">print</span>(A.dtype)
</pre>
</div>

<pre class="example">
int64
</pre>


<p>
We could change it to a <code>float64</code> array:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = A.astype(<span style="color: #3fb83f; font-weight: bold;">float</span>)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A.dtype)
</pre>
</div>

<pre class="example">
float64
</pre>


<p>
Or <code>float32</code>:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = A.astype(np.float32)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A.dtype)
</pre>
</div>

<pre class="example">
float32
</pre>
</div>
</div>

<div id="outline-container-org6615147" class="outline-4">
<h4 id="org6615147"><span class="section-number-4">1.2.5.</span> Different ways of creating arrays</h4>
<div class="outline-text-4" id="text-1-2-5">
<p>
NumPy also provides us with a number of different functions to create arrays. Instead
of doing this:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([[0, 0], [0, 0]])
</pre>
</div>

<p>
We could instead use the <code>np.zeros</code> function, passing a tuple where each element of
the tuple describes how many elements should be made in each dimension:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.zeros((2,)) <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">1 dimensional</span>
<span style="color: #78afff;">A</span> = np.zeros((2, 2))  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">2 dimensional</span>
<span style="color: #78afff;">A</span> = np.zeros((2, 5, 5))  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">3 dimensional</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2c050dd" class="outline-4">
<h4 id="org2c050dd"><span class="section-number-4">1.2.6.</span> Different ways of creating arrays</h4>
<div class="outline-text-4" id="text-1-2-6">
<p>
Another commonly used array creation function is the <code>np.random.randn</code> function. This
creates an array where elements are sampled from a normal distribution.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.random.randn(2, 2)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[-0.68213848 -0.44274759]
# =&gt;  [ 0.6748596   0.64244208]]
</pre>


<p>
<b>Note</b> the interface is a little different than <code>.zeros</code>, where instead of passing a
tuple, we pass multiple arguments to the function.
</p>
</div>
</div>

<div id="outline-container-orge017e19" class="outline-4">
<h4 id="orge017e19"><span class="section-number-4">1.2.7.</span> Different ways of creating arrays</h4>
<div class="outline-text-4" id="text-1-2-7">
<p>
It is also convenient to create arrays with ranges of elements.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.arange(5, 10) <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">optional step</span>
<span style="color: #3fb83f; font-weight: bold;">print</span>(A)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [5 6 7 8 9]
</pre>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.linspace(5, 10, 20)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [ 5.          5.26315789  5.52631579  5.78947368  6.05263158  6.31578947
# =&gt;   6.57894737  6.84210526  7.10526316  7.36842105  7.63157895  7.89473684
# =&gt;   8.15789474  8.42105263  8.68421053  8.94736842  9.21052632  9.47368421
# =&gt;   9.73684211 10.        ]
</pre>
</div>
</div>


<div id="outline-container-org8c7adc1" class="outline-4">
<h4 id="org8c7adc1"><span class="section-number-4">1.2.8.</span> Different ways of creating arrays</h4>
<div class="outline-text-4" id="text-1-2-8">
<p>
There are many more ways to create arrays. Some include:
</p>

<ul class="org-ul">
<li><code>np.ones</code>  - a matrix of 1's</li>
<li><code>np.eye</code> - an identity matrix</li>
<li><code>np.diag</code> - create a matrix with supplied elements across the diagonal</li>
<li><code>np.fromfunction</code> - load elements from the return of a function</li>
<li><code>np.fromfile</code> - load elements from a data file</li>
</ul>

<p>
Though, the best resource for understanding is NumPy's own documentation on the
subject: <a href="https://numpy.org/doc/stable/user/basics.creation.html">https://numpy.org/doc/stable/user/basics.creation.html</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org8c5c930" class="outline-3">
<h3 id="org8c5c930"><span class="section-number-3">1.3.</span> Indexing Arrays</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-orgc503412" class="outline-4">
<h4 id="orgc503412"><span class="section-number-4">1.3.1.</span> Slicing NumPy arrays</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
In native Python, when we have a 'matrix' like data structure (just a list of lists),
and we want to access a particular element from this matrix, we have to do something
like:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = [[1, 2], [3, 4]]
<span style="color: #3fb83f; font-weight: bold;">print</span>(A[1][0])
</pre>
</div>

<pre class="example">
Results: 
# =&gt; 3
</pre>


<p>
However, in NumPy, we seperate the indexes by comma:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([[1, 2], [3, 4]])
<span style="color: #3fb83f; font-weight: bold;">print</span>(A[1, 0])
</pre>
</div>

<pre class="example">
Results: 
# =&gt; 3
</pre>
</div>
</div>

<div id="outline-container-org76d8cf9" class="outline-4">
<h4 id="org76d8cf9"><span class="section-number-4">1.3.2.</span> Slicing NumPy Arrays</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
If we wanted to get all elements from the 2nd column we would use the <code>:</code> notation. For
example:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([[1, 2], [3, 4]])
<span style="color: #3fb83f; font-weight: bold;">print</span>(A[:, 1])
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [2 4]
</pre>


<p>
Likewise, all elements from the 2nd row:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(A[1, :])
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [3 4]
</pre>
</div>
</div>

<div id="outline-container-orgfedb997" class="outline-4">
<h4 id="orgfedb997"><span class="section-number-4">1.3.3.</span> Slicing NumPy Arrays</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
Note that when we slice an array, we are <b>not copying</b> the elements:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([[1, 2], [3, 4]])
<span style="color: #78afff;">b</span> = A[:, 1]

<span style="color: #78afff;">b</span>[0] = 10

<span style="color: #3fb83f; font-weight: bold;">print</span>(A)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[ 1 10]
# =&gt;  [ 3  4]]
</pre>


<p>
Any modification you make to the <code>b</code> variable will also affect <code>A</code>. For that we must use
<code>.copy()</code>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([[1, 2], [3, 4]])
<span style="color: #78afff;">b</span> = A[:, 1].copy()
...
</pre>
</div>
</div>
</div>

<div id="outline-container-org60f6731" class="outline-4">
<h4 id="org60f6731"><span class="section-number-4">1.3.4.</span> Slicing NumPy Arrays</h4>
<div class="outline-text-4" id="text-1-3-4">
<p>
If we have a multi-dimensional array, to which we wish to index on the final
dimension, one way to achieve this is by doing the following:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.random.randn(10, 2, 5, 4)  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">our array to slice</span>
A[:, :, :, 1:2]  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">slice on the last dimension</span>
</pre>
</div>

<p>
This can get pretty tedious the more that the number of dimensions increases. But! we
have one syntactical shortcut at our disposal: the ellipses '&#x2026;'. Using the ellipses
in place of the many ':' slices on each dimension, we're telling NumPy to just take
all elements from the prior dimensions. For example:
</p>

<div class="org-src-container">
<pre class="src src-python">A[..., 1:2]  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">same slice on the last dimension</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3a7dda9" class="outline-4">
<h4 id="org3a7dda9"><span class="section-number-4">1.3.5.</span> Slicing NumPy Arrays</h4>
<div class="outline-text-4" id="text-1-3-5">

<div id="org51c6699" class="figure">
<p><img src="./images/indexing.png" alt="indexing.png" />
</p>
<p><span class="figure-number">Figure 1: </span>Johansson, R., Johansson, R., &amp; John, S. (2019). Numerical Python (Vol. 1). Apress.P</p>
</div>
</div>
</div>

<div id="outline-container-org0e7a4a0" class="outline-4">
<h4 id="org0e7a4a0"><span class="section-number-4">1.3.6.</span> Boolean Indexing</h4>
<div class="outline-text-4" id="text-1-3-6">
<p>
NumPy arrays can also be composed of boolean elements
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([[1, -1], [0, 5]])
<span style="color: #3fb83f; font-weight: bold;">print</span>(A &gt; 0)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[ True False]
# =&gt;  [False  True]]
</pre>


<p>
And we can also use boolean elements to help with indexing:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">values_above_zero</span> = A[A &gt; 0]
<span style="color: #3fb83f; font-weight: bold;">print</span>(values_above_zero)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [1 5]
</pre>
</div>
</div>

<div id="outline-container-org675b0ba" class="outline-4">
<h4 id="org675b0ba"><span class="section-number-4">1.3.7.</span> Boolean Indexing</h4>
<div class="outline-text-4" id="text-1-3-7">
<p>
Therefore we can apply computations to only part of the array using this indexing
feature:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">mask</span> = A &gt; 0
<span style="color: #78afff;">A</span>[<span style="color: #78afff;">mask</span>] = A[mask] + 10
<span style="color: #3fb83f; font-weight: bold;">print</span>(A)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[11 -1]
# =&gt;  [ 0 15]]
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf5d26fc" class="outline-3">
<h3 id="orgf5d26fc"><span class="section-number-3">1.4.</span> Reshaping and Resizing</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-org25fba56" class="outline-4">
<h4 id="org25fba56"><span class="section-number-4">1.4.1.</span> Reshape</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
After an array has been created, we can modify its structure/shape using various
functions. The first we shall look at is <code>.reshape</code>. For example, let us create a
vector of 4 elements and then reshape it into an array of 2x2 elements. Of course,
the new shape of the array must be proportional to the original number of elements:
2x2 elements = 4 elements.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.arange(1, 5)

<span style="color: #78afff;">mat_A</span> = A.reshape(2, 2)
<span style="color: #3fb83f; font-weight: bold;">print</span>(mat_A)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A)  <span style="color: #b7a07f; font-style: italic;"># </span><span style="color: #b7a07f; font-style: italic;">A is not changed! No need for copy</span>
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[1 2]
# =&gt;  [3 4]]
# =&gt; [1 2 3 4]
</pre>
</div>
</div>

<div id="outline-container-org14d2d01" class="outline-4">
<h4 id="org14d2d01"><span class="section-number-4">1.4.2.</span> Flatten</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
If we wanted to take a 2d array and reshape it into a vector, we could of course use
the <code>.reshape</code> function again. But we could also use <code>.flatten</code>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">flat_A</span> = mat_A.flatten()
<span style="color: #3fb83f; font-weight: bold;">print</span>(flat_A)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [1 2 3 4]
</pre>
</div>
</div>

<div id="outline-container-org37fae44" class="outline-4">
<h4 id="org37fae44"><span class="section-number-4">1.4.3.</span> Flatten</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
When specifying the new dimensionality of the reshaped array, <code>-1</code> is a shortcut to
specify the dimensionality to allow reshaping to occur correctly. For example:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.arange(1, 5)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A)

<span style="color: #3fb83f; font-weight: bold;">print</span>(A.reshape(2, -1))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [1 2 3 4]
# =&gt; [[1 2]
# =&gt;  [3 4]]
</pre>


<p>
We're telling NumPy to create an array with 2 elements on the 1st dimension, and then
however many elements on the second dimension.
</p>
</div>
</div>

<div id="outline-container-org115abe3" class="outline-4">
<h4 id="org115abe3"><span class="section-number-4">1.4.4.</span> Add a dimension</h4>
<div class="outline-text-4" id="text-1-4-4">
<p>
We can add and remove dimensions using <code>.expand_dims</code> and <code>.squeeze</code>, respectively.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(A)
<span style="color: #3fb83f; font-weight: bold;">print</span>(np.expand_dims(A, 1))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [1 2 3 4]
# =&gt; [[1]
# =&gt;  [2]
# =&gt;  [3]
# =&gt;  [4]]
</pre>


<p>
We are taking a vector and adding a dimension. Note that we have to use
<code>np.expand_dims</code> passing the object we want to expand and not <code>A.expand_dims</code>.
</p>
</div>
</div>

<div id="outline-container-orgf1d423d" class="outline-4">
<h4 id="orgf1d423d"><span class="section-number-4">1.4.5.</span> Add a dimension</h4>
<div class="outline-text-4" id="text-1-4-5">
<p>
We can use an indexing trick with <code>None</code> to do the expansion in just the same way:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(A)
<span style="color: #3fb83f; font-weight: bold;">print</span>(A[:, <span style="color: #37aff6;">None</span>])
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [1 2 3 4]
# =&gt; [[1]
# =&gt;  [2]
# =&gt;  [3]
# =&gt;  [4]]
</pre>


<p>
Where <code>None</code> indicates to NumPy where we want to add the new dimension.
</p>
</div>
</div>

<div id="outline-container-orgd2929f3" class="outline-4">
<h4 id="orgd2929f3"><span class="section-number-4">1.4.6.</span> Remove a dimension</h4>
<div class="outline-text-4" id="text-1-4-6">
<p>
If we want to instead remove a dimension, we can use <code>.squeeze()</code>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(A[:, <span style="color: #37aff6;">None</span>].squeeze(1))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [1 2 3 4]
</pre>


<p>
We are removing the 2nd dimension, but <b>note</b> that the elements must be singletons. So
you cannot squeeze a 2x2 array.
</p>
</div>
</div>

<div id="outline-container-orgd8d06d0" class="outline-4">
<h4 id="orgd8d06d0"><span class="section-number-4">1.4.7.</span> Matrix transpose</h4>
<div class="outline-text-4" id="text-1-4-7">
<p>
Another useful feature is the matrix transpose:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(mat_A)

<span style="color: #3fb83f; font-weight: bold;">print</span>(mat_A.transpose())
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[1 2]
# =&gt;  [3 4]]
# =&gt; [[1 3]
# =&gt;  [2 4]]
</pre>


<p>
or even:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(mat_A.T)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[1 3]
# =&gt;  [2 4]]
</pre>
</div>
</div>


<div id="outline-container-org5a09bed" class="outline-4">
<h4 id="org5a09bed"><span class="section-number-4">1.4.8.</span> Composing arrays</h4>
<div class="outline-text-4" id="text-1-4-8">
<p>
If we have multiple arrays we want to 'join' together, we can use <code>np.hstack</code> for
horizontally joining, or <code>np.vstack</code> for vertically joining arrays. <b>Note</b> the dimensions
must match in the direction your stacking.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([1, 2, 3])
<span style="color: #78afff;">B</span> = np.array([4, 5, 6])

<span style="color: #3fb83f; font-weight: bold;">print</span>(np.hstack([A, B]))
</pre>
</div>

<pre class="example">
[1 2 3 4 5 6]
</pre>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(np.vstack([A, B]))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[1 2 3]
# =&gt;  [4 5 6]]
</pre>
</div>
</div>

<div id="outline-container-org245c738" class="outline-4">
<h4 id="org245c738"><span class="section-number-4">1.4.9.</span> Composing arrays using concatenate</h4>
<div class="outline-text-4" id="text-1-4-9">
<p>
<code>hstack</code> and <code>vstack</code> can be useful when the required output shape is simply
defined. However, there is a more general function - <code>np.concatenate</code> - that will be
more often useful to us.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(np.concatenate([A, B], axis=0))
</pre>
</div>

<pre class="example">
[1 2 3 4 5 6]
</pre>


<p>
Here we see that we can achieve the same result as <code>np.hstack</code> using
<code>concatenate</code>. Notice also that there is a second argument to the <code>concatenate</code> function:
the dimension upon which the concatenation will take place.
</p>

<p>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html">https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org99d1fb4" class="outline-3">
<h3 id="org99d1fb4"><span class="section-number-3">1.5.</span> Arithmetic Operations</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-org3a6fdbe" class="outline-4">
<h4 id="org3a6fdbe"><span class="section-number-4">1.5.1.</span> Arithmetic Operations</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
We have already seen some basic examples of arithmetic operations in NumPy. But its
worth looking at these in detail.
</p>

<p>
One of the best reasons to use NumPy is that the computations are <b>vectorized</b> and can
be <b>broadcast</b>. We'll see examples of what these mean.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([1, 2, 3])
<span style="color: #78afff;">B</span> = np.array([[1, 2, 3],
              [4, 5, 6]])

<span style="color: #3fb83f; font-weight: bold;">print</span>(A * B)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[ 1  4  9]
# =&gt;  [ 4 10 18]]
</pre>


<p>
We can perform vector and matrix arithmetic using Python's infix operators like <code>+</code>, <code>*</code>,
etc.
</p>
</div>
</div>

<div id="outline-container-orgad0f7e0" class="outline-4">
<h4 id="orgad0f7e0"><span class="section-number-4">1.5.2.</span> Arithmetic Operations</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
When we perform arithmetic operations, NumPy will convert the data into arrays for
us. While this can help, its not best practice for vectors and matrices, for scalars
it will be fine.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = [1, 2, 3]

<span style="color: #3fb83f; font-weight: bold;">print</span>(A * B)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[ 1  4  9]
# =&gt;  [ 4 10 18]]
</pre>
</div>
</div>

<div id="outline-container-org3e6894d" class="outline-4">
<h4 id="org3e6894d"><span class="section-number-4">1.5.3.</span> Broadcasting</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
When we are working with singletons or scalar values, NumPy will automatically
perform the broadcasting for us. So for example, if we want to double each element of
an array:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(B * 2)
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [[ 2  4  6]
# =&gt;  [ 8 10 12]]
</pre>


<p>
NumPy will automatically broadcast the scalar <code>2</code> to every element of the shape and
size of <code>B</code>.
</p>
</div>
</div>

<div id="outline-container-orgef1f6d3" class="outline-4">
<h4 id="orgef1f6d3"><span class="section-number-4">1.5.4.</span> Comparison with Functions</h4>
<div class="outline-text-4" id="text-1-5-4">
<p>
NumPy provides, in many cases, both infix and function operations.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Operation</th>
<th scope="col" class="org-left">Infix</th>
<th scope="col" class="org-left">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Addition</td>
<td class="org-left">+</td>
<td class="org-left">np.add</td>
</tr>

<tr>
<td class="org-left">Subtraction</td>
<td class="org-left">-</td>
<td class="org-left">np.subtract</td>
</tr>

<tr>
<td class="org-left">Multiplication</td>
<td class="org-left">*</td>
<td class="org-left">np.multiply</td>
</tr>

<tr>
<td class="org-left">Division</td>
<td class="org-left">/</td>
<td class="org-left">np.divide</td>
</tr>

<tr>
<td class="org-left">Matrix Multiplication</td>
<td class="org-left">@</td>
<td class="org-left">np.matmul</td>
</tr>

<tr>
<td class="org-left">Power</td>
<td class="org-left">**</td>
<td class="org-left">np.power</td>
</tr>

<tr>
<td class="org-left">Cos/Tan/Sin</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">np.cos, np.tan, np.sin</td>
</tr>

<tr>
<td class="org-left">Square root</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">np.sqrt</td>
</tr>

<tr>
<td class="org-left">Exponential, Logarithm</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">np.exp, np.log</td>
</tr>
</tbody>
</table>

<p>
<a href="https://numpy.org/doc/stable/reference/routines.math.html">https://numpy.org/doc/stable/reference/routines.math.html</a>
</p>
</div>
</div>

<div id="outline-container-orge48eda8" class="outline-4">
<h4 id="orge48eda8"><span class="section-number-4">1.5.5.</span> More complex operations</h4>
<div class="outline-text-4" id="text-1-5-5">
<p>
There are a number of different operations one can perform on a matrix. Such as the
dot product of two matrices:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.array([1, 2])
<span style="color: #78afff;">B</span> = np.array([[1, 2], [3, 4]])
<span style="color: #3fb83f; font-weight: bold;">print</span>(np.dot(A, B))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [ 7 10]
</pre>


<p>
The inner product:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(np.inner(A, B))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [ 5 11]
</pre>
</div>
</div>

<div id="outline-container-orgdd40513" class="outline-4">
<h4 id="orgdd40513"><span class="section-number-4">1.5.6.</span> More complex operations</h4>
<div class="outline-text-4" id="text-1-5-6">
<p>
One mystical function is the <code>einsum</code> function. This function can effectively replace
other functions like <code>dot</code> and <code>inner</code> but it takes some understanding on how it
works. <code>einsum</code> is the application of Einstein Summation, a succinct method of
describing the multiplication between matrices. Lets first look at an example of the outer product:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(np.einsum(<span style="color: #af9fff;">'i,ij-&gt;j'</span>, A, B))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [ 7 10]
</pre>


<p>
Or the inner product:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #3fb83f; font-weight: bold;">print</span>(np.einsum(<span style="color: #af9fff;">'j,ij-&gt;i'</span>, A, B))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [ 5 11]
</pre>
</div>
</div>

<div id="outline-container-orgd1bc3f8" class="outline-4">
<h4 id="orgd1bc3f8"><span class="section-number-4">1.5.7.</span> More complex operations</h4>
<div class="outline-text-4" id="text-1-5-7">
<p>
In <code>einsum</code> we are giving a letter for each dimension of each array we pass to the
function.
</p>

<p>
So with: <code>'i,ij-&gt;j'</code> for the inner product of matrices A and B, we are saying that the
first dimension of A (its only dimension) is labelled i, while for B the dimensions
are labelled as i and j respectively. The labels that exist in both sequences are
summed over. 
</p>

<p>
Einsum can take a little time to fully understand and appreciate, but it can be a
very powerful function with a very succinct syntax.
</p>

<p>
<a href="https://www.youtube.com/watch?v=CLrTj7D2fLM">https://www.youtube.com/watch?v=CLrTj7D2fLM</a> - Khan Academy - Einstein Summation Convention
</p>
</div>
</div>

<div id="outline-container-org669236b" class="outline-4">
<h4 id="org669236b"><span class="section-number-4">1.5.8.</span> Vectorizing a function</h4>
<div class="outline-text-4" id="text-1-5-8">
<p>
Lets say you have some function that computes the square of a number:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #00c089; font-weight: bold;">def</span> <span style="color: #7fc500;">my_square</span>(x):
    <span style="color: #00c089; font-weight: bold;">return</span> x**2

<span style="color: #3fb83f; font-weight: bold;">print</span>(my_square(4))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; 16
</pre>


<p>
As the function is simple, it takes one argument and returns one argument, we can
pass a NumPy array and will get the correct result.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">A</span> = np.arange(1, 10)
<span style="color: #3fb83f; font-weight: bold;">print</span>(my_square(A))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [ 1  4  9 16 25 36 49 64 81]
</pre>
</div>
</div>

<div id="outline-container-org6344f1b" class="outline-4">
<h4 id="org6344f1b"><span class="section-number-4">1.5.9.</span> Vectorize a function</h4>
<div class="outline-text-4" id="text-1-5-9">
<p>
However, if the function is more complicated, it will not work.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #00c089; font-weight: bold;">def</span> <span style="color: #7fc500;">myfunc</span>(a, b):
    <span style="color: #7fc07f; font-style: italic;">"Return a-b if a&gt;b, otherwise return a+b"</span>
    <span style="color: #00c089; font-weight: bold;">if</span> a &gt; b:
        <span style="color: #00c089; font-weight: bold;">return</span> a - b
    <span style="color: #00c089; font-weight: bold;">else</span>:
        <span style="color: #00c089; font-weight: bold;">return</span> a + b

<span style="color: #3fb83f; font-weight: bold;">print</span>(myfunc(A, 2))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; Traceback (most recent call last):
# =&gt;   File "&lt;stdin&gt;", line 1, in &lt;module&gt;
# =&gt;   File "/tmp/pyqVNaN0", line 3, in &lt;module&gt;
# =&gt;   File "/tmp/babel-jHhWMz/python-nKlyRH", line 8, in &lt;module&gt;
# =&gt;     print(myfunc(A, 2))
# =&gt;   File "/tmp/babel-jHhWMz/python-nKlyRH", line 3, in myfunc
# =&gt;     if a &gt; b:
# =&gt; ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</pre>
</div>
</div>

<div id="outline-container-orgebe3856" class="outline-4">
<h4 id="orgebe3856"><span class="section-number-4">1.5.10.</span> Vectorize a function</h4>
<div class="outline-text-4" id="text-1-5-10">
<p>
To allow us to use this function over an array, we can use the <code>np.vectorize</code> function
to create a new function, which applies <code>myfunc</code> over each element.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #78afff;">vfunc</span> = np.vectorize(myfunc)
<span style="color: #3fb83f; font-weight: bold;">print</span>(vfunc(A, 2))
</pre>
</div>

<pre class="example">
Results: 
# =&gt; [3 4 1 2 3 4 5 6 7]
</pre>


<p>
Here we pass the function we want to vectorize <code>myfunc</code> to the <code>np.vectorize</code>
function. The return of this function is another function!
</p>
</div>
</div>

<div id="outline-container-orgd87c913" class="outline-4">
<h4 id="orgd87c913"><span class="section-number-4">1.5.11.</span> Reading more</h4>
<div class="outline-text-4" id="text-1-5-11">
<p>
We've only scratched the surface of what NumPy can offer us! One of the best starting
points for learning about NumPy is NumPy's own user guide on the web: <a href="https://numpy.org/doc/stable/user/index.html">https://numpy.org/doc/stable/user/index.html</a>
</p>

<ul class="org-ul">
<li>Linear Algebra tutorial <a href="https://numpy.org/doc/stable/user/tutorial-svd.html">https://numpy.org/doc/stable/user/tutorial-svd.html</a></li>
<li>Boolean expressions <a href="https://numpy.org/doc/stable/reference/routines.logic.html">https://numpy.org/doc/stable/reference/routines.logic.html</a></li>
<li>Set operations <a href="https://numpy.org/doc/stable/reference/routines.set.html">https://numpy.org/doc/stable/reference/routines.set.html</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 21st September 2022</p>
<p class="author">Author: Jay Morgan</p>
<p class="date">Created: 2022-10-10 Mon 10:57</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
